!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){function t(t){var s=t||window.event,h=l.call(arguments,1),d=0,f=0,c=0,g=0,u=0,w=0;if(t=e.event.fix(s),t.type="mousewheel","detail"in s&&(c=-1*s.detail),"wheelDelta"in s&&(c=s.wheelDelta),"wheelDeltaY"in s&&(c=s.wheelDeltaY),"wheelDeltaX"in s&&(f=-1*s.wheelDeltaX),"axis"in s&&s.axis===s.HORIZONTAL_AXIS&&(f=-1*c,c=0),d=0===c?f:c,"deltaY"in s&&(c=-1*s.deltaY,d=c),"deltaX"in s&&(f=s.deltaX,0===c&&(d=-1*f)),0!==c||0!==f){if(1===s.deltaMode){var p=e.data(this,"mousewheel-line-height");d*=p,c*=p,f*=p}else if(2===s.deltaMode){var $=e.data(this,"mousewheel-page-height");d*=$,c*=$,f*=$}if(g=Math.max(Math.abs(c),Math.abs(f)),(!n||n>g)&&(n=g,a(s,g)&&(n/=40)),a(s,g)&&(d/=40,f/=40,c/=40),d=Math[d>=1?"floor":"ceil"](d/n),f=Math[f>=1?"floor":"ceil"](f/n),c=Math[c>=1?"floor":"ceil"](c/n),r.settings.normalizeOffset&&this.getBoundingClientRect){var v=this.getBoundingClientRect();u=t.clientX-v.left,w=t.clientY-v.top}return t.deltaX=f,t.deltaY=c,t.deltaFactor=n,t.offsetX=u,t.offsetY=w,t.deltaMode=0,h.unshift(t,d,f,c),o&&clearTimeout(o),o=setTimeout(i,200),(e.event.dispatch||e.event.handle).apply(this,h)}}function i(){n=null}function a(e,t){return r.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120===0}var o,n,s=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],h="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(e.event.fixHooks)for(var d=s.length;d;)e.event.fixHooks[s[--d]]=e.event.mouseHooks;var r=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var i=h.length;i;)this.addEventListener(h[--i],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",r.getLineHeight(this)),e.data(this,"mousewheel-page-height",r.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var i=h.length;i;)this.removeEventListener(h[--i],t,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var i=e(t),a=i["offsetParent"in e.fn?"offsetParent":"parent"]();return a.length||(a=e("body")),parseInt(a.css("fontSize"),10)||parseInt(i.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})});var dh=$(window).height(),dw=$(window).width(),bgWidth=4972,bgHeight=700,bgMaxHeight=760,whRatio=bgWidth/bgHeight,getActualSize=function(){{var e,t=$(window).height();$(window).width()}return e=t>=bgHeight?bgMaxHeight>=t?t:bgMaxHeight:bgHeight,{width:4972/bgHeight*e,height:e}},resetBg=function(){dh=$(window).height(),dw=$(window).width();var e=getActualSize(),t=e.width,i=e.height,a=$(".site-content").offset();$(".site-content").height(i).width(t),$(".extended-bg").height(872*i/700).width(t);var o=-1*a.left+dw-t;o>0&&($(".site-content").css({left:$(".site-content").offset().left+o+"px"}),$(".extended-bg").css({left:$(".site-content").offset().left+o+"px"}));var n=Math.abs(a.left)/($(".site-content").width()-$(window).width()),s=$(".progress-bar").width(),h=(.9*s-32)*n+.05*s;$(".progress-indicator").css({left:h+"px"})},resetDog=function(){$(".sitting-dog").width(351*$(window).height()/bgHeight)},resetHotspot=function(){var e=47/700*$(window).height(),t=e,i=getActualSize(),a=i.width;$(".hotspot").each(function(){$(this).width(t).height(e),$(this).css({left:$(this).attr("px")/bgWidth*a+"px",top:$(this).attr("py")/bgHeight*i.height+"px"})})},resetHotspotCt=function(){$(".hotspot-ct > div").each(function(){var e=$(this).attr("width"),t=$(this).attr("height"),i=t/bgHeight*$(window).height(),a=i*e/t,o=($(window).height()-i)/2;$(this).height(i).width(a).css({top:o+"px"})})},resize=function(){resetBg(),resetDog(),resetHotspot(),resetHotspotCt();var e=24/556,t=$(".dump-contract").height()*e+"px";$(".sisters-count").css({"font-size":t})},scrollBg=function(e){var t=$(".site-content").offset(),i=getActualSize(),a=i.width;if(e>0)t.left<0&&($(".site-content").css({left:t.left+Math.abs(Math.abs(t.left)>Math.abs(e)?e:t.left)+"px"}),$(".extended-bg").css({left:t.left+Math.abs(Math.abs(t.left)>Math.abs(e)?e:t.left)+"px"}));else if(t.left+$(window).width()<a){var o=a-(Math.abs(t.left)+$(window).width());$(".site-content").css({left:t.left-Math.abs(Math.abs(o)>Math.abs(e)?e:o)+"px"}),$(".extended-bg").css({left:t.left-Math.abs(Math.abs(o)>Math.abs(e)?e:o)+"px"})}if(t.left<0){var n=Math.abs(t.left)/($(".site-content").width()-$(window).width()),s=$(".progress-bar").width(),h=(.9*s-32)*n+.05*s;$(".progress-indicator").css({left:h+"px"})}};$(window).resize(function(){resize()});var wheeldelta={x:0,y:0},wheeling,leftOffset;$(window).on("mousewheel",function(e){var t=getActualSize(),i=t.width;if(e.preventDefault(),!wheeling){console.log("start wheeling!");var a=$(".site-content").offset(),o=a.left;$(".progress").fadeIn(100)}clearTimeout(wheeling),wheeling=setTimeout(function(){console.log("stop wheeling!"),wheeling=void 0,wheeldelta.x=0,wheeldelta.y=0;var e=$(".site-content").offset(),t=o-e.left;0!==t&&(Math.abs(e.left)/i>=699/bgWidth?$(".sitting-dog").show():$(".sitting-dog").hide()),$(".progress").fadeOut(800)},250);var a=$(".site-content").offset();Math.abs(a.left)/i<699/bgWidth?$(".sitting-dog").fadeOut():$(".sitting-dog").is(":visible")||$(".sitting-dog").fadeIn(),wheeldelta.x+=e.deltaFactor*e.deltaX,wheeldelta.y+=e.deltaFactor*e.deltaY,console.log("delta x : "+wheeldelta.x+"delta y : "+wheeldelta.y);var n=Math.tan(5*Math.PI/180);scrollBg(0==wheeldelta.x||Math.abs(wheeldelta.y)/Math.abs(wheeldelta.x)>n?e.deltaY*e.deltaFactor:e.deltaX*e.deltaFactor)});var rotating,rotateIndex=0,rotateMag=function(){clearTimeout(rotating),rotating=setTimeout(rotateMag,3e3),++rotateIndex>3&&(rotateIndex%=4),$(".mag-page-ct.active").fadeOut(500,function(){$(this).removeClass("active").addClass("inactive"),$("#mag-page-"+rotateIndex).fadeIn(500,function(){$(this).removeClass("inactive").addClass("active")})}),3!=rotateIndex&&$(".mag-page-3-vplayer-ct").fadeOut(function(){$(this).find(".video_player").html("")})},magzineVideo="<iframe height=100% width=100% src='http://static.youku.com/v/swf/qplayer.swf?VideoIDS=XODkxMDU5MjAw&isAutoPlay=true&isShowRelatedVideo=false&embedid=-&showAd=0' frameborder=0 allowfullscreen></iframe>",video2_1_1="<iframe height=100% width=100% src='http://static.youku.com/v/swf/qplayer.swf?VideoIDS=XODgyNzQzOTQ4&isAutoPlay=true&isShowRelatedVideo=false&embedid=-&showAd=0' frameborder=0 allowfullscreen></iframe>",video2_4_1="<iframe height=100% width=100% src='http://static.youku.com/v/swf/qplayer.swf?VideoIDS=XOTAxMTUzOTI0&isAutoPlay=true&isShowRelatedVideo=false&embedid=-&showAd=0' frameborder=0 allowfullscreen></iframe>";$(function(){resize(),$(".hotspot").click(function(){var e=$(this).attr("id"),t="#"+e+"-ct",i="#"+e+"-player";$(t).fadeIn(function(){"hotspot-1"===e&&setTimeout(rotateMag,1e3),"hotspot-2-1"==e?$(i)&&$(i).html(video2_1_1):"hotspot-2-4"==e&&$(i)&&$(i).html(video2_4_1)})}),$(".hotspot-close").click(function(){$(this).parent().parent().fadeOut(),$(this).parent().find(".video_player").each(function(){$(this).html("")}),$(".mag-page-3-vplayer-ct").fadeOut()}),$(".mag-nav-mask").mouseover(function(){clearTimeout(rotating);var e=$(this).attr("val");$(".mag-page-ct.active").fadeOut(500,function(){$(this).removeClass("active").addClass("inactive"),$("#mag-page-"+e).fadeIn(500,function(){$(this).removeClass("inactive").addClass("active")})}),3!=e&&$(".").fadeOut(function(){$(this).find(".video_player").html("")})}),$(".next-page-arrow").click(function(){var e="-"+$(this).parent().width()+"px";$(this).parents(".slide-wrapper").animate({marginLeft:e},600)}),$(".prev-page-arrow").click(function(){$(this).parents(".slide-wrapper").animate({marginLeft:"0"},600)}),$(".mag-page-3-video-preview").click(function(){clearTimeout(rotating),$(".mag-page-3-vplayer-ct").fadeIn(function(){$(this).find(".video_player").html(magzineVideo)})}),$(".mag-page-3-vplayer-ct").hover(function(){$(".video_player_close").fadeIn()}),$(".video_player_close").click(function(){$(".mag-page-3-vplayer-ct").fadeOut(function(){$(this).find(".video_player").html("")})})});